<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8" />
    <link rel="stylesheet" href="css/notify.css">
    <title>Notify 監聽頁面</title>
</head>
<body>
    <h1>即時通知監聽</h1>
    <ul id="notifyList"></ul>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <script>
        // Firebase 設定
        const firebaseConfig = {
            apiKey: "AIzaSyCppoyrgeZsWad4Zss93GdjjTdlCybn5Zk",
            authDomain: "so101-f8079.firebaseapp.com",
            projectId: "so101-f8079",
            storageBucket: "so101-f8079.appspot.com",
            messagingSenderId: "1035056506659",
            appId: "1:1035056506659:web:93a76861ae259218bb8e96",
            databaseURL: "https://so101-f8079-default-rtdb.firebaseio.com"
        };
        firebase.initializeApp(firebaseConfig);

        const db = firebase.database();
        const notifyList = document.getElementById('notifyList');

        // 監聽 /notify 路徑有新資料時
        db.ref('notify').on('child_added', function(snapshot) {
            const data = snapshot.val();
            const li = document.createElement('li');
            li.textContent = `時間: ${new Date(data.time).toLocaleString()}，按鈕ID: ${data.buttonId}`;
            notifyList.prepend(li); // 新的顯示在最上面

            // 超過20筆時清理多餘的
            while (notifyList.children.length > 20) {
                notifyList.removeChild(notifyList.lastChild);
            }
        });
    </script>
</body>
</html>